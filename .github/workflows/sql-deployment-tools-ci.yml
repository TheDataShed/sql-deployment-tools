name: SQL Deployment Tools CI

on:
  push:
    branches:
      - '**'
  pull_request:
    branches: main

jobs:
  pre_commit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        name: Checkout Repository

      - name: Run Pre-Commit
        run: |
          python -m pip install --requirement ./requirements/test.txt
          pre-commit run --all-files

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        name: Checkout Repository

      - name: Run Tests
        run: |
          echo 'Run some pytest stuff here'

  build_debian:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        name: Checkout Repository
      
      - name: Build Executable (Debian)
        run: |
          echo "Validating Debian Build"
          sh ./platform/linux_debian/build.sh
  
  build_windows:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v3
        name: Checkout Repository

      - name: Build Executable (Windows)
        run: |
          echo "Validating Windows Build"
          ./platform/windows/build.bat

  build_macosx:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v3
        name: Checkout Repository
        
      - name: Build Executable (Mac OSX)
        run: |
          echo "Validating Mac OSX Build"
          sh ./platform/mac_osx/build.sh